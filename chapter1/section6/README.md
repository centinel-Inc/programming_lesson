# ç¬¬ 6 ç¯€ æŠ½é¸ãƒ•ã‚©ãƒ¼ãƒ ã¸ã®å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã—ã‚ˆã†

### å®Œæˆå½¢

```sh
git clone https://github.com/centinel-jp/programming_lesson.git
cd programming_lesson/chapter1/section6/
python3 section6.py
```

æŠ½é¸ã« Google ãƒ•ã‚©ãƒ¼ãƒ ãŒä½¿ã‚ã‚Œã¦ã„ãŸã¨ã—ã¦è©±ã‚’é€²ã‚ã¾ã™

1. ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

<img src="./images/5.jpg">

2. ãƒ•ã‚©ãƒ¼ãƒ ã«é …ç›®ã‚’è¿½åŠ 

<img src="./images/6.jpg">

3. å®Œæˆ

<img src="./images/7.jpg">

## 2. ä½•ã‚’å®Ÿç¾ã—ãŸã„ã‹è€ƒãˆã‚‹

https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform

1. ãƒ•ã‚©ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã‚’é–‹ã

<img src="./images/2.jpg">

2. æƒ…å ±ã‚’å…¥åŠ›ã™ã‚‹

<img src="./images/3.jpg">

3. é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™

<img src="./images/4.jpg">

## 3. å®Ÿç¾æ–¹æ³•ã‚’èª¿æŸ»ã™ã‚‹

<img src="./images/1.jpg">

ä¸€ç•ªä¸Šã®è¨˜äº‹ãŒè‰¯ã•ãã†

https://qiita.com/kota-yata/items/9d4124ec7a7dd4e3d4f0

### ã‚ã‹ã£ãŸã“ã¨

1. Selenium ã¨ã‹ã„ã†ã‚‚ã®ã‚’ä½¿ã£ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã™ã‚‹ã‚‰ã—ã„
2. Google Form ã¯ URL ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€åˆæœŸå€¤ã‚’æŒã£ãŸçŠ¶æ…‹ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãã“ã¨ãŒã§ãã‚‹ã‚‰ã—ã„
   - `usp=pp_url` ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä»˜ä¸
   - `entry.ç•ªå·=å›ç­”å†…å®¹` ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä»˜ä¸

## 4. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ã¿ã‚‹

1. ãƒ•ã‚©ãƒ¼ãƒ ä¸­èº«ã‚’ Chrome ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦è¦—ãã€ `entry.ç•ªå·` ã®è¦å‰‡æ€§ã‚’èª¿ã¹ã‚‹

```
é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã®é–‹ãæ–¹

Mac -> CMD + Opt + i
Windows -> Ctrl + Shift + i
```

2. çµæœ

<img src="./images/8.jpg">

3. ã¾ã¨ã‚ãŸ

```
entry.1029139045 -> æ°å
entry.387916820 -> ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
entry.1239014792 -> é›»è©±ç•ªå·
entry.1382078040 -> ä½æ‰€
entry.731826105_year -> ç”Ÿå¹´æœˆæ—¥ã®å¹´
entry.731826105_month -> ç”Ÿå¹´æœˆæ—¥ã®æœˆ
entry.731826105_day -> ç”Ÿå¹´æœˆæ—¥ã®æ—¥
```

4. 3 ã‚’ URL ã«åæ˜ ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã„ã¦

ãƒ•ã‚©ãƒ¼ãƒ ã® URL ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®é–“ã«`?`ã‚’å…¥ã‚Œã€ãã‚Œã‹ã‚‰ã¯`&`ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åŒºåˆ‡ã£ã¦ã„ã

ã¾ãšã¯è©¦ã—ã«æ°åã ã‘

https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå

<img src="./images/9.jpg">

ã§ã¯å…¨éƒ¨å…¥ã‚Š

https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå&entry.387916820=test@gmail.com&entry.1239014792=0000-0000-0000&entry.1382078040=TEST prefecture&entry.731826105_year=1996&entry.731826105_month=7&entry.731826105_day=17

## 5. 4 ã§ã§ããŸ URL ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰é–‹ã

```
pip3 install selenium
pip3 install pandas
```

```python
from selenium import webdriver
import time

# ãƒ•ã‚©ãƒ¼ãƒ ã®URLã‚’å¤‰æ•°ã§ä¿æŒã™ã‚‹
form_url = 'https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå&entry.387916820=test@gmail.com&entry.1239014792=0000-0000-0000&entry.1382078040=TEST prefecture&entry.731826105_year=1996&entry.731826105_month=7&entry.731826105_day=17';

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
driver = webdriver.Chrome()

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
driver.get(form_url)

# 3ç§’é–“å¾…ã¤
# ã‚ã‹ã‚Šã‚„ã™ãã™ã‚‹ãŸã‚
time.sleep(3)

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹
driver.close()

# ãƒ¡ãƒ¢ãƒªã‚’è§£æ”¾ã™ã‚‹
driver.quit()
```

## 6. é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰æŠ¼ã™

### Selenium ã§ãƒœã‚¿ãƒ³ã‚’æŠ¼ã•ã›ã‚‹ãŸã‚ã«ã¯ã€ãƒœã‚¿ãƒ³ã®ç‰¹å¾´ã‚’æ•™ãˆã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚‹

- class
- id
- [xpath](https://www.octoparse.jp/blog/xpath-introduction/) ğŸ‘ˆ ä»Šå›ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹

### é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‹ã‚‰ xpath ã‚’ã‚³ãƒ”ãƒ¼

<img src="./images/10.jpg">

### å®Ÿéš›ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰æŠ¼ã™

```python
from selenium import webdriver
import time

# ãƒ•ã‚©ãƒ¼ãƒ ã®URLã‚’å¤‰æ•°ã§ä¿æŒã™ã‚‹
form_url = 'https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå&entry.387916820=test@gmail.com&entry.1239014792=0000-0000-0000&entry.1382078040=TEST prefecture&entry.731826105_year=1996&entry.731826105_month=7&entry.731826105_day=17';

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
driver = webdriver.Chrome()

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
driver.get(form_url)

# 1ç§’é–“å¾…ã¤
# ã‚ã‹ã‚Šã‚„ã™ãã™ã‚‹ãŸã‚
time.sleep(1)

# ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦é€ä¿¡ã™ã‚‹
path = '//*[@id="mG61Hd"]/div[2]/div/div[3]/div[1]/div[1]/div' # ã‚³ãƒ”ãƒ¼ã—ãŸãƒœã‚¿ãƒ³ã®xpathã‚’è²¼ã‚Šä»˜ã‘ã‚‹
driver.find_element_by_xpath(path).click()

# 3ç§’é–“å¾…ã¤
time.sleep(3)

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹
driver.close()

# ãƒ¡ãƒ¢ãƒªã‚’è§£æ”¾ã™ã‚‹
driver.quit()
```

# ç•ªå¤–ç·¨ ä½¿ã„ã‚„ã™ãã—ã‚ˆã†

## 7. ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€

ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚’ CSV å½¢å¼ã§ç”¨æ„ã—ã¾ã™
|æ°å|ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹|é›»è©±ç•ªå·|ä½æ‰€|å¹´|æœˆ|æ—¥|
|:----|:----|:----|:----|:----|:----|:----|
|ãƒ†ã‚¹ãƒˆã‚¿ãƒ­ã‚¦ 0|test0@gmail.com|0800000000|æ±äº¬éƒ½|1990|1|10|
|ãƒ†ã‚¹ãƒˆã‚¿ãƒ­ã‚¦ 1|test1@gmail.com|08011111111|ç¥å¥ˆå·çœŒ|1991|1|11|

### CSV ã‚’èª­ã¿è¾¼ã‚€

```python
import pandas as pd

# CSVã‚’èª­ã¿è¾¼ã‚€
df = pd.read_csv('./data.csv', dtype=str)

# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ—ãƒªãƒ³ãƒˆã—ã¦ç¢ºèªã—ã¦ã¿ã‚‹
print(df)
```

### èª­ã¿å–ã£ãŸ CSV ã‚’ä¸€åˆ—ã”ã¨ã«å–ã‚Šå‡ºã—ã¦å€¤ã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹

```python
import pandas as pd

# CSVã‚’èª­ã¿è¾¼ã‚€
# å‹ã®ãƒ’ãƒ³ãƒˆã‚’æ›¸ãã“ã¨ã§è£œå®ŒãŒåŠ¹ãã‚ˆã†ã«ãªã‚‹
df: pd.DataFrame = pd.read_csv('./data.csv', dtype=str)

# ä¸€åˆ—ã”ã¨ã«å‡¦ç†ã§ãã‚‹
for index, row in df.iterrows():
    # ã©ã®ã‚ˆã†ãªå€¤ãŒå…¥ã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ã¿ã‚‹
    # print(index)

    # ä¸Šã®ç¢ºèªãŒã§ããŸã‚‰ã€ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã—ã¦ã“ã¡ã‚‰ã‚‚ç¢ºèªã—ã¦ã¿ã‚‹
    # print(row)

    # å€¤ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹
    # ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚­ãƒ¼åã‚’æŒ‡å®šã™ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹
    print(row['æ°å'])
    print(row['é›»è©±ç•ªå·'])

    # ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚‚å–å¾—ã§ãã‚‹
    # ã‚·ãƒ³ã‚°ãƒ«ãƒ»ãƒ€ãƒ–ãƒ«ã©ã¡ã‚‰ã§ã‚‚è‰¯ã„ã®ã ãŒã€ã©ã¡ã‚‰ã‹ä¸€æ–¹ã«ä¸€è²«ã—ãŸæ–¹ãŒå¤‰ãªæ„å›³ã‚’æ„Ÿã˜ã•ã›ãšèª­ã¿ã‚„ã™ã„ã¨æ€ã†
    print(row["æ°å"])
    print(row["é›»è©±ç•ªå·"])
```

## 8. èª­ã¿å–ã£ãŸ CSV ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹æº–å‚™ã‚’è¡Œã†

èª­ã¿å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’è¾æ›¸å‹ã®å¤‰æ•°ã«æ ¼ç´ã—ã€ãã®å¤‰æ•°ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¤‰æ›ã—ãŸã„ã€‚
ãã®ãŸã‚è¾æ›¸å‹ã®å¤‰æ•°ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¸å¤‰æ›ã™ã‚‹é–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```python
# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹è¾æ›¸å‹ã®å¤‰æ•°
# keyã«urlãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã€valueã«å…¥ã‚‹è¦ç´ åã‚’å…¥ã‚Œã‚‹ï¼ˆvalueã¯ã‚ã‹ã‚Šã‚„ã™ã‘ã‚Œã°é©å½“ãªå€¤ã§ã‚‚å¤§ä¸ˆå¤«ï¼‰
url_param_dict = {
    'usp': 'pp_url',
    'entry.1029139045': 'æ°å',
    'entry.387916820': 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
    'entry.1239014792': 'é›»è©±ç•ªå·',
    'entry.1382078040': 'ä½æ‰€',
    'entry.731826105_year': 'å¹´',
    'entry.731826105_month': 'æœˆ',
    'entry.731826105_day': 'æ—¥',
}

def convertDictToUrlParams(params):
    params_string = ''
    for key, value in params.items():
        params_string += '&' + key + "=" + value

    # æœ€åˆã®ã€Œ&ã€ã‚’å‰Šé™¤ã—ã¦ã„ã‚‹ã€‚URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€åˆã¯ã€Œ&ã€ã§ã¯ãªã„ãŸã‚ã€‚
    # ã“ã“ã§ã¯ã€Œã‚¹ãƒ©ã‚¤ã‚¹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’ä½¿ã„ã€"1ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹"ä»¥é™ã®æ–‡å­—ã‚’å–å¾—ã—ã¦ã„ã‚‹
    # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯0å§‹ã¾ã‚Šãªã®ã§ã€2æ–‡å­—ç›®ä»¥é™ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ãªã‚‹
    return params_string[1:]

# æœŸå¾…ã—ã¦ã„ã‚‹å€¤
expect = 'usp=pp_url&entry.1029139045=æ°å&entry.387916820=ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹&entry.1239014792=é›»è©±ç•ªå·&entry.1382078040=ä½æ‰€&entry.731826105_year=å¹´&entry.731826105_month=æœˆ&entry.731826105_day=æ—¥'
actual = convertDictToUrlParams(url_param_dict)

# æœŸå¾…ã™ã‚‹å€¤ã«ãªã£ã¦ã„ã‚‹ã‹ãƒ†ã‚¹ãƒˆã‚’è¡Œã†
if expect == actual:
    print('ğŸ‰æœŸå¾…ã™ã‚‹å€¤ã§ã™ğŸ‰')
else:
    print'ğŸ¥²æœŸå¾…ã™ã‚‹æ–‡å­—åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“ğŸ¥²')
```

## 9. èª­ã¿å–ã£ãŸ CSV ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹

```python
import pandas as pd

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹è¾æ›¸å‹ã®å¤‰æ•°
# keyã«urlãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã€valueã«å…¥ã‚‹è¦ç´ åã‚’å…¥ã‚Œã‚‹ï¼ˆvalueã¯ã‚ã‹ã‚Šã‚„ã™ã‘ã‚Œã°é©å½“ãªå€¤ã§ã‚‚å¤§ä¸ˆå¤«ï¼‰
url_param_dict = {
    'usp': 'pp_url',
    'entry.1029139045': 'æ°å',
    'entry.387916820': 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
    'entry.1239014792': 'é›»è©±ç•ªå·',
    'entry.1382078040': 'ä½æ‰€',
    'entry.731826105_year': 'å¹´',
    'entry.731826105_month': 'æœˆ',
    'entry.731826105_day': 'æ—¥',
}

def convertDictToUrlParams(params):
    params_string = ''
    for key, value in params.items():
        params_string += '&' + key + "=" + value

    # æœ€åˆã®ã€Œ&ã€ã‚’å‰Šé™¤ã—ã¦ã„ã‚‹ã€‚URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€åˆã¯ã€Œ&ã€ã§ã¯ãªã„ãŸã‚ã€‚
    # ã“ã“ã§ã¯ã€Œã‚¹ãƒ©ã‚¤ã‚¹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’ä½¿ã„ã€"1ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹"ä»¥é™ã®æ–‡å­—ã‚’å–å¾—ã—ã¦ã„ã‚‹
    # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯0å§‹ã¾ã‚Šãªã®ã§ã€2æ–‡å­—ç›®ä»¥é™ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ãªã‚‹
    return params_string[1:]

# CSVã‚’èª­ã¿è¾¼ã‚€
# å‹ã®ãƒ’ãƒ³ãƒˆã‚’æ›¸ãã“ã¨ã§VS Codeã«ã¦è£œå®ŒãŒåŠ¹ãã‚ˆã†ã«ãªã‚‹
df: pd.DataFrame = pd.read_csv('./data.csv', dtype=str)

for index, row in df.iterrows():
    # CSVãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹ãŸã‚ã€è¾æ›¸å‹ã®å¤‰æ•°ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ç”¨æ„ã™ã‚‹
    # url_param_dictã«å‰¯ä½œç”¨ã‚’åŠã¼ã—ãŸããªã„ã®ã§ã€å€¤ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¸€æ™‚çš„ãªå¤‰æ•°ã‚’ç”¨æ„ã™ã‚‹
    temp_url_param_dict = url_param_dict.copy()

    # è¾æ›¸å‹ã®keyã«valueã‚’ä»£å…¥ã—ãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¡Œã„ã¾ã™ã€‚
    temp_url_param_dict['entry.1029139045'] = row['æ°å']

    # å¤‰æ•°ã®ä¸­èº«ã‚’ã“ã¾ã‚ã«printã—ã¦ç¢ºèªã™ã‚‹ã¨ã€çŠ¶æ³ã‚’æŠŠæ¡ã—ã‚„ã™ãåŠ¹ç‡ã‚ˆãé–‹ç™ºã§ãã‚‹ã®ã§ãŠã™ã™ã‚ã§ã™
    # ä»¥ä¸‹ã®ã‚ˆã†ã«æ–‡å­—åˆ—ã«å¤‰æ•°ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã€printã™ã‚‹ã“ã¨ãŒã§ãã¾ã™
    # ä»–ã®è¨€èªã§ã‚‚æ–¹æ³•ã¯é•ã„ã¾ã™ãŒã€å¯èƒ½ã§ã™ã®ã§èª¿ã¹ã¦ã¿ã¦ãã ã•ã„
    print('url_param_dictã®æ°åã¯ã€Œ{}ã€ã§ã€temp_url_param_dictã®æ°åã¯ã€Œ{}ã€ã§ã™ã€‚'.format(url_param_dict['entry.1029139045'], temp_url_param_dict['entry.1029139045']))

    temp_url_param_dict['entry.1029139045'] = row['ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹']
    temp_url_param_dict['entry.387916820'] = row['é›»è©±ç•ªå·']
    temp_url_param_dict['entry.1239014792'] = row['ä½æ‰€']
    temp_url_param_dict['entry.731826105_year'] = row['å¹´']
    temp_url_param_dict['entry.731826105_month'] = row['æœˆ']
    temp_url_param_dict['entry.731826105_day'] = row['æ—¥']

    # URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—åˆ—ã‚’çµ„ã¿ç«‹ã¦ã‚‹
    url_params = convertDictToUrlParams(temp_url_param_dict)
    print("urlParams: {}".format(url_params))
```

## 10. ä»Šã¾ã§ä½œã£ã¦ããŸã‚‚ã®ã‚’çµ„ã¿åˆã‚ã›ã¦ã€CSV ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚©ãƒ¼ãƒ ã¸æŠ•ç¨¿ã™ã‚‹æ©Ÿèƒ½ã‚’å®Œæˆã•ã›ã‚‹

```python
import pandas as pd
from selenium import webdriver
import time

# Googleãƒ•ã‚©ãƒ¼ãƒ ã®URL
form_url = 'https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform'

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹è¾æ›¸å‹ã®å¤‰æ•°
# keyã«urlãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã€valueã«å…¥ã‚‹è¦ç´ åã‚’å…¥ã‚Œã‚‹ï¼ˆvalueã¯ã‚ã‹ã‚Šã‚„ã™ã‘ã‚Œã°é©å½“ãªå€¤ã§ã‚‚å¤§ä¸ˆå¤«ï¼‰
url_param_dict = {
    'usp': 'pp_url',
    'entry.1029139045': 'æ°å',
    'entry.387916820': 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
    'entry.1239014792': 'é›»è©±ç•ªå·',
    'entry.1382078040': 'ä½æ‰€',
    'entry.731826105_year': 'å¹´',
    'entry.731826105_month': 'æœˆ',
    'entry.731826105_day': 'æ—¥',
}

def convertDictToUrlParams(params):
    params_string = ''
    for key, value in params.items():
        params_string += '&' + key + "=" + value

    # æœ€åˆã®ã€Œ&ã€ã‚’å‰Šé™¤ã—ã¦ã„ã‚‹ã€‚URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€åˆã¯ã€Œ&ã€ã§ã¯ãªã„ãŸã‚ã€‚
    # ã“ã“ã§ã¯ã€Œã‚¹ãƒ©ã‚¤ã‚¹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’ä½¿ã„ã€"1ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹"ä»¥é™ã®æ–‡å­—ã‚’å–å¾—ã—ã¦ã„ã‚‹
    # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯0å§‹ã¾ã‚Šãªã®ã§ã€2æ–‡å­—ç›®ä»¥é™ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ãªã‚‹
    return params_string[1:]

# CSVã‚’èª­ã¿è¾¼ã‚€
# å‹ã®ãƒ’ãƒ³ãƒˆã‚’æ›¸ãã“ã¨ã§VS Codeã«ã¦è£œå®ŒãŒåŠ¹ãã‚ˆã†ã«ãªã‚‹
df: pd.DataFrame = pd.read_csv('./data.csv', dtype=str)

for index, row in df.iterrows():
    # CSVãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹ãŸã‚ã€è¾æ›¸å‹ã®å¤‰æ•°ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ç”¨æ„ã™ã‚‹
    # urlParamDictã«å‰¯ä½œç”¨ã‚’åŠã¼ã—ãŸããªã„ã®ã§ã€å€¤ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¸€æ™‚çš„ãªå¤‰æ•°ã‚’ç”¨æ„ã™ã‚‹
    temp_url_param_dict = url_param_dict.copy()

    # è¾æ›¸å‹ã®keyã«valueã‚’ä»£å…¥ã—ãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¡Œã„ã¾ã™ã€‚
    temp_url_param_dict['entry.1029139045'] = row['æ°å']
    temp_url_param_dict['entry.1029139045'] = row['ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹']
    temp_url_param_dict['entry.387916820'] = row['é›»è©±ç•ªå·']
    temp_url_param_dict['entry.1239014792'] = row['ä½æ‰€']
    temp_url_param_dict['entry.731826105_year'] = row['å¹´']
    temp_url_param_dict['entry.731826105_month'] = row['æœˆ']
    temp_url_param_dict['entry.731826105_day'] = row['æ—¥']

    # URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—åˆ—ã‚’çµ„ã¿ç«‹ã¦ã‚‹
    urlParams = convertDictToUrlParams(temp_url_param_dict)

    form_url_with_params = form_url + "?" + urlParams;

    # ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
    driver = webdriver.Chrome()

    # ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
    driver.get(form_url_with_params)

    # 1ç§’é–“å¾…ã¤
    time.sleep(1)

    # ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦é€ä¿¡ã™ã‚‹
    path = '//*[@id="mG61Hd"]/div[2]/div/div[3]/div[1]/div[1]/div'
    driver.find_element_by_xpath(path).click()

    # 3ç§’é–“å¾…ã¤
    time.sleep(3)

    # ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹
    driver.close()

    # ãƒ¡ãƒ¢ãƒªã‚’è§£æ”¾ã™ã‚‹
    driver.quit()
```
