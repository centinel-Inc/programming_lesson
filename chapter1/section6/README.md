# ç¬¬ 6 ç¯€ Google ãƒ•ã‚©ãƒ¼ãƒ ã¸ã®å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã—ã‚ˆã†

## 1. Google ãƒ•ã‚©ãƒ¼ãƒ ã®æº–å‚™ã‚’ã™ã‚‹

1. ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

<img src="./images/5.jpg" width="400px">

2. ãƒ•ã‚©ãƒ¼ãƒ ã«é …ç›®ã‚’è¿½åŠ 

<img src="./images/6.jpg" width="400px">

3. å®Œæˆ

<img src="./images/7.jpg" width="400px">

## 2. ä½•ã‚’å®Ÿç¾ã—ãŸã„ã‹è€ƒãˆã‚‹

https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform

1. ãƒ•ã‚©ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã‚’é–‹ã

<img src="./images/2.jpg" width="400px">

2. æƒ…å ±ã‚’å…¥åŠ›ã™ã‚‹

<img src="./images/3.jpg" width="400px">

3. é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™

<img src="./images/4.jpg" width="400px">

## 3. å®Ÿç¾æ–¹æ³•ã‚’èª¿æŸ»ã™ã‚‹

<img src="./images/1.jpg" width="400px">

ä¸€ç•ªä¸Šã®è¨˜äº‹ãŒè‰¯ã•ãã†

https://qiita.com/kota-yata/items/9d4124ec7a7dd4e3d4f0

### ã‚ã‹ã£ãŸã“ã¨

1. Selenium ã¨ã‹ã„ã†ã‚‚ã®ã‚’ä½¿ã£ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã™ã‚‹ã‚‰ã—ã„
2. Google Form ã¯ URL ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€åˆæœŸå€¤ã‚’æŒã£ãŸçŠ¶æ…‹ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãã“ã¨ãŒã§ãã‚‹ã‚‰ã—ã„
   - `usp=pp_url` ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä»˜ä¸
   - `entry.ç•ªå·=å›ç­”å†…å®¹` ã‚’ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä»˜ä¸

## 4. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã„ã¦

1. ãƒ•ã‚©ãƒ¼ãƒ ä¸­èº«ã‚’ Chrome ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦è¦—ãã€ `entry.ç•ªå·` ã®è¦å‰‡æ€§ã‚’èª¿ã¹ã‚‹

```
é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã®é–‹ãæ–¹

Mac -> CMD + Opt + i
Windows -> Ctrl + Shift + i
```

2. çµæœ

<img src="./images/8.jpg" width="400px">

3. ã¾ã¨ã‚ãŸ

```
entry.1029139045 -> æ°å
entry.387916820 -> ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
entry.1239014792 -> é›»è©±ç•ªå·
entry.1382078040 -> ä½æ‰€
entry.731826105_year -> ç”Ÿå¹´æœˆæ—¥ã®å¹´
entry.731826105_month -> ç”Ÿå¹´æœˆæ—¥ã®æœˆ
entry.731826105_day -> ç”Ÿå¹´æœˆæ—¥ã®æ—¥
```

4. 3 ã‚’ URL ã«åæ˜ ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã„ã¦

ãƒ•ã‚©ãƒ¼ãƒ ã® URL ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®é–“ã«`?`ã‚’å…¥ã‚Œã€ãã‚Œã‹ã‚‰ã¯`&`ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åŒºåˆ‡ã£ã¦ã„ã

ã¾ãšã¯è©¦ã—ã«æ°åã ã‘

https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå

<img src="./images/9.jpg" width="400px">

ã§ã¯å…¨éƒ¨å…¥ã‚Š

https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå&entry.387916820=test@gmail.com&entry.1239014792=0000-0000-0000&entry.1382078040=TEST prefecture&entry.731826105_year=1996&entry.731826105_month=7&entry.731826105_day=17

## 5. 4 ã§ã§ããŸURLã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰é–‹ã„ã¦

```
pip3 install selenium
pip3 install pandas
```

```python
from selenium import webdriver
import time

# ãƒ•ã‚©ãƒ¼ãƒ ã®URLã‚’å¤‰æ•°ã§ä¿æŒã™ã‚‹
form_url = 'https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå&entry.387916820=test@gmail.com&entry.1239014792=0000-0000-0000&entry.1382078040=TEST prefecture&entry.731826105_year=1996&entry.731826105_month=7&entry.731826105_day=17';

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
driver = webdriver.Chrome()

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
driver.get(form_url)

# 5ç§’é–“å¾…ã¤
time.sleep(5)

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹
driver.close()

# ãƒ¡ãƒ¢ãƒªã‚’è§£æ”¾ã™ã‚‹
driver.quit()
```

## 6. ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦

### Seleniumã§ãƒœã‚¿ãƒ³ã‚’æŠ¼ã•ã›ã‚‹ãŸã‚ã«ã¯ã€ãƒœã‚¿ãƒ³ã®ç‰¹å¾´ã‚’æ•™ãˆã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚‹
- class
- id
- [xpath](https://www.octoparse.jp/blog/xpath-introduction/) ğŸ‘ˆ ä»Šå›ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹

### é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‹ã‚‰xpathã‚’ã‚³ãƒ”ãƒ¼

<img src="./images/10.jpg" width="400px">


### å®Ÿè¡Œã—ã¦

```python
from selenium import webdriver
import time

# ãƒ•ã‚©ãƒ¼ãƒ ã®URLã‚’å¤‰æ•°ã§ä¿æŒã™ã‚‹
form_url = 'https://docs.google.com/forms/d/e/1FAIpQLSfoth2f2lJXwrpZSAwoW8iHeKOBnx4Ks7jesk_t65MLb_Otxw/viewform?usp=pp_url&entry.1029139045=URLã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆå&entry.387916820=test@gmail.com&entry.1239014792=0000-0000-0000&entry.1382078040=TEST prefecture&entry.731826105_year=1996&entry.731826105_month=7&entry.731826105_day=17';

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
driver = webdriver.Chrome()

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
driver.get(form_url)

# ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦é€ä¿¡ã™ã‚‹
path = '//*[@id="mG61Hd"]/div[2]/div/div[3]/div[1]/div[1]/div' # ã‚³ãƒ”ãƒ¼ã—ãŸãƒœã‚¿ãƒ³ã®xpathã‚’è²¼ã‚Šä»˜ã‘ã‚‹
driver.find_element_by_xpath(path).click()

# 5ç§’é–“å¾…ã¤
time.sleep(5)

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹
driver.close()

# ãƒ¡ãƒ¢ãƒªã‚’è§£æ”¾ã™ã‚‹
driver.quit()
```

# ç•ªå¤–ç·¨ ä½¿ã„ã‚„ã™ãã—ã‚ˆã†

## 7. ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€

ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚’CSVå½¢å¼ã§ç”¨æ„ã—ã¾ã™
|æ°å|ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹|é›»è©±ç•ªå·|ä½æ‰€|å¹´|æœˆ|æ—¥|
|:----|:----|:----|:----|:----|:----|:----|
|ãƒ†ã‚¹ãƒˆã‚¿ãƒ­ã‚¦0|test0@gmail.com|0800000000|æ±äº¬éƒ½|1990|1|10|
|ãƒ†ã‚¹ãƒˆã‚¿ãƒ­ã‚¦1|test1@gmail.com|08011111111|ç¥å¥ˆå·çœŒ|1991|1|11|

### CSVã‚’èª­ã¿è¾¼ã‚€

```python
import pandas as pd

# CSVã‚’èª­ã¿è¾¼ã‚€
df = pd.read_csv('./data.csv', dtype=str)

# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ—ãƒªãƒ³ãƒˆã—ã¦ç¢ºèªã—ã¦ã¿ã‚‹
print(df)
```

### èª­ã¿å–ã£ãŸCSVã‚’ä¸€åˆ—ã”ã¨ã«å–ã‚Šå‡ºã—ã¦ã¿ã‚‹

```python
import pandas as pd

# CSVã‚’èª­ã¿è¾¼ã‚€
# å‹ã®ãƒ’ãƒ³ãƒˆã‚’æ›¸ãã“ã¨ã§è£œå®ŒãŒåŠ¹ãã‚ˆã†ã«ãªã‚‹
df: pd.DataFrame = pd.read_csv('./data.csv', dtype=str)

# ä¸€åˆ—ã”ã¨ã«å‡¦ç†ã§ãã‚‹
for index, row in df.iterrows():
    # ã©ã®ã‚ˆã†ãªå€¤ãŒå…¥ã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ã¿ã‚‹
    print(index)

    # ä¸Šã®ç¢ºèªãŒã§ããŸã‚‰ã€ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã—ã¦ã“ã¡ã‚‰ã‚‚ç¢ºèªã—ã¦ã¿ã‚‹
    # print(row)
```

## 8. èª­ã¿å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹æº–å‚™ã‚’è¡Œã†

èª­ã¿å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’è¾æ›¸å‹ã®å¤‰æ•°ã«æ ¼ç´ã—ã€ãã®å¤‰æ•°ã‚’URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¤‰æ›ã—ãŸã„ã€‚
ãã®ãŸã‚è¾æ›¸å‹ã®å¤‰æ•°ã‹ã‚‰URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¸å¤‰æ›ã™ã‚‹é–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹ã€‚

```python
# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹è¾æ›¸å‹ã®å¤‰æ•°
# keyã«urlãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã€valueã«å…¥ã‚‹è¦ç´ åã‚’å…¥ã‚Œã‚‹ï¼ˆvalueã¯ã‚ã‹ã‚Šã‚„ã™ã‘ã‚Œã°é©å½“ãªå€¤ã§ã‚‚å¤§ä¸ˆå¤«ï¼‰
urlParamDict = {
    'usp': 'pp_url',
    'entry.1029139045': 'æ°å',
    'entry.387916820': 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
    'entry.1239014792': 'é›»è©±ç•ªå·',
    'entry.1382078040': 'ä½æ‰€',
    'entry.731826105_year': 'å¹´',
    'entry.731826105_month': 'æœˆ',
    'entry.731826105_day': 'æ—¥',
}

def convertDictToUrlParams(params):
    """[summary]

    Args:
        params (Dict): å…¥åŠ›ã—ãŸã„å€¤ã‚’è¾æ›¸å‹ã§è¡¨ç¾ã—ãŸå€¤

    Returns:
        string: paramsã‚’URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¤‰æ›ã—ãŸå€¤
        (ä¾‹) param1=value1&param2=value2&param3=value3
    """
    paramsString = ''
    for key, value in params.items():
        paramsString += '&' + key + "=" + value
    
    # æœ€åˆã®ã€Œ&ã€ã‚’å‰Šé™¤ã—ã¦ã„ã‚‹ã€‚URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€åˆã¯ã€Œ&ã€ã§ã¯ãªã„ãŸã‚ã€‚
    # ã“ã“ã§ã¯ã€Œã‚¹ãƒ©ã‚¤ã‚¹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’ä½¿ã„ã€"1ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹"ä»¥é™ã®æ–‡å­—ã‚’å–å¾—ã—ã¦ã„ã‚‹
    # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯0å§‹ã¾ã‚Šãªã®ã§ã€2æ–‡å­—ç›®ä»¥é™ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ãªã‚‹
    return paramsString[1:]

# æœŸå¾…ã—ã¦ã„ã‚‹å€¤
expect = 'usp=pp_url&entry.1029139045=æ°å&entry.387916820=ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹&entry.1239014792=é›»è©±ç•ªå·&entry.1382078040=ä½æ‰€&entry.731826105_year=å¹´&entry.731826105_month=æœˆ&entry.731826105_day=æ—¥'
actual = convertDictToUrlParams(urlParamDict)

# æœŸå¾…ã™ã‚‹å€¤ã«ãªã£ã¦ã„ã‚‹ã‹ãƒ†ã‚¹ãƒˆã‚’è¡Œã†
if expect == actual:
    print("ğŸ‰æœŸå¾…ã™ã‚‹å€¤ã§ã™ğŸ‰")
else:
    print("ğŸ¥²æœŸå¾…ã™ã‚‹æ–‡å­—åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“ğŸ¥²")
```


